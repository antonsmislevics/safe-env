
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://antonsmislevics.github.io/safe-env/working-with-envs/">
      
      
        <link rel="prev" href="../getting-started/">
      
      
        <link rel="next" href="../working-with-secrets/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.49">
    
    
      
        <title>Working with environments - Safe Environment Manager (safe-env)</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.6f8fc17f.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#working-with-environments" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Safe Environment Manager (safe-env)" class="md-header__button md-logo" aria-label="Safe Environment Manager (safe-env)" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Safe Environment Manager (safe-env)
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Working with environments
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="light-blue" data-md-color-accent="light-blue"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="light-blue" data-md-color-accent="light-blue"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/antonsmislevics/safe-env" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Safe Environment Manager (safe-env)" class="md-nav__button md-logo" aria-label="Safe Environment Manager (safe-env)" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Safe Environment Manager (safe-env)
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/antonsmislevics/safe-env" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting started
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Working with environments
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Working with environments
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#how-to-define-environments" class="md-nav__link">
    <span class="md-ellipsis">
      How to define environments?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-load-environment" class="md-nav__link">
    <span class="md-ellipsis">
      How to load environment?
    </span>
  </a>
  
    <nav class="md-nav" aria-label="How to load environment?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#option-1-run-process-application" class="md-nav__link">
    <span class="md-ellipsis">
      Option 1: Run process / application
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#option-2-set-environment-variables-in-current-shell" class="md-nav__link">
    <span class="md-ellipsis">
      Option 2: Set environment variables in current shell
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#option-3-generate-the-file-for-use-with-docker" class="md-nav__link">
    <span class="md-ellipsis">
      Option 3: Generate the file for use with Docker
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#option-4-generate-env-file-not-recommended" class="md-nav__link">
    <span class="md-ellipsis">
      Option 4: Generate .env file (not recommended)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-definedebug-more-complex-config-files" class="md-nav__link">
    <span class="md-ellipsis">
      How to define/debug more complex config files?
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../working-with-secrets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Working with secrets
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../plugins/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Developing plugins
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="working-with-environments">Working with environments</h1>
<p>In this section we cover how to define and use environment configuration files for <strong>safe-env</strong>.</p>
<h2 id="how-to-define-environments">How to define environments?</h2>
<p>To start using <strong>safe-env</strong> you first need to create environment configuration files. By default the tool looks for these files in <em>./envs</em> folder. However, custom path can be provided via <code>--config-dir</code> option.</p>
<p>Configuration files are based on <a href="https://omegaconf.readthedocs.io">OmegaConf</a>, and have only two special sections:
<div class="highlight"><pre><span></span><code><span class="nt">depends_on</span><span class="p">:</span><span class="w">     </span><span class="c1"># the list of &quot;parent&quot; environment configurations (optional)</span>
<span class="nt">envs</span><span class="p">:</span><span class="w">           </span><span class="c1"># dictionary with resulting environment variables</span>
</code></pre></div></p>
<p>Configuration files can be parametrized using standard OmegaConf variable interpolation and resolvers.</p>
<p>Here are three examples of simple configuration files. To keep things simple, we are not loading any secrets yet - this will be covered later.</p>
<p>This is a base environment configuration file.
<div class="highlight"><span class="filename">./envs/base.yaml</span><pre><span></span><code><span class="nt">params</span><span class="p">:</span>
<span class="w">  </span><span class="nt">param1</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">param1_value</span>
<span class="w">  </span><span class="nt">param2</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">param2_value</span>
<span class="w">  </span><span class="nt">param3</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">param3_value</span>
<span class="w">  </span><span class="nt">env_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">base_env</span>
<span class="nt">envs</span><span class="p">:</span>
<span class="w">  </span><span class="nt">var1</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">var1</span>
<span class="w">  </span><span class="nt">var2</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;${params.param1}</span><span class="nv"> </span><span class="s">-</span><span class="nv"> </span><span class="s">${params.param2}&quot;</span>
<span class="w">  </span><span class="nt">var3</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${params.param3}</span>
<span class="w">  </span><span class="nt">env_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${params.env_name}</span>
</code></pre></div></p>
<p>This is a development environment configuration file. It inherits from base and overrides one parameter and one environment variable.
<div class="highlight"><span class="filename">./envs/dev.yaml</span><pre><span></span><code><span class="nt">depends_on</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">base</span>
<span class="nt">params</span><span class="p">:</span>
<span class="w">  </span><span class="nt">env_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dev_env</span>
<span class="nt">envs</span><span class="p">:</span>
<span class="w">  </span><span class="nt">var1</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dev_var1</span>
</code></pre></div></p>
<p>This is an example of a configuration file that could be used as an add-on when working in corporate environment behind the proxy.
<div class="highlight"><span class="filename">./envs/local.yaml</span><pre><span></span><code><span class="nt">envs</span><span class="p">:</span>
<span class="w">  </span><span class="nt">http_proxy</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http-proxy-url&quot;</span>
<span class="w">  </span><span class="nt">https_proxy</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https-proxy-url&quot;</span>
<span class="w">  </span><span class="nt">no_proxy</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;no-proxy-configuration&quot;</span>
</code></pre></div></p>
<h2 id="how-to-load-environment">How to load environment?</h2>
<p>First, let's list available environment configurations:</p>
<div class="highlight"><pre><span></span><code>$ se list

+-------+-----------------+
| Name  |      Path       |
+-------+-----------------+
| base  | envs/base.yaml  |
|  dev  |  envs/dev.yaml  |
| local | envs/local.yaml |
+-------+-----------------+
</code></pre></div>
<p>Now we can inspect how loaded environment variables for <em>base</em> and <em>dev</em> environments look.</p>
<div class="highlight"><pre><span></span><code>$ se activate base

var1: var1
var2: param1_value - param2_value
var3: param3_value
env_name: base_env

$ se activate dev

var1: dev_var1
var2: param1_value - param2_value
var3: param3_value
env_name: dev_env
</code></pre></div>
<p>And if we are working with <em>dev</em> environment behind the proxy, we can add <em>local</em> environment configuration as an add-on.</p>
<div class="highlight"><pre><span></span><code>$ se activate dev local

var1: dev_var1
var2: param1_value - param2_value
var3: param3_value
env_name: dev_env
http_proxy: http-proxy-url
https_proxy: https-proxy-url
no_proxy: no-proxy-configuration
</code></pre></div>
<p>Finally, we need to set values of these environment variables in the current working shell or in the process where our application will be executed. Depending on your situation, there are several ways do this.</p>
<h3 id="option-1-run-process-application">Option 1: Run process / application</h3>
<p>First, we can call <code>se run</code> to run another process / application with loaded environment variables.</p>
<p>For example:
<div class="highlight"><pre><span></span><code><span class="c1"># run printenv to show which environment variables are set in sub process</span>
<span class="c1"># NOTE: --no-host-envs option specifies that other environment variables from the host will not be available to subprocess</span>
$<span class="w"> </span>se<span class="w"> </span>run<span class="w"> </span>dev<span class="w"> </span>--no-host-envs<span class="w"> </span>--cmd<span class="w"> </span><span class="s2">&quot;printenv&quot;</span>

<span class="nv">var1</span><span class="o">=</span>dev_var1
<span class="nv">var2</span><span class="o">=</span>param1_value<span class="w"> </span>-<span class="w"> </span>param2_value
<span class="nv">var3</span><span class="o">=</span>param3_value
<span class="nv">env_name</span><span class="o">=</span>dev_env
</code></pre></div></p>
<p>If another application is a Python module, we can run it with <code>--python-module</code> or <code>-py</code> option:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>se<span class="w"> </span>run<span class="w"> </span>dev<span class="w"> </span>--no-host-envs<span class="w"> </span>-py<span class="w"> </span>--cmd<span class="w"> </span><span class="s2">&quot;uvicorn my_fastapi_webapp.app:app --reload --port 8080 --host 0.0.0.0&quot;</span>
</code></pre></div>
<p>In this case <strong>safe-env</strong> will configure environment variables and invoke this module in the same process. As a result, the following debug configuration in VSCode <em>launch.json</em> will start web application with environment variables for <em>dev</em> configuration and attach a debugger:</p>
<div class="highlight"><span class="filename">.vscode/launch.json</span><pre><span></span><code><span class="c1">// ... </span>
<span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Debug FastAPI with dev env variables&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;debugpy&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;request&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;launch&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;module&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;safe_env&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;run&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;dev&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;-py&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;--cmd&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;uvicorn my_fastapi_webapp.app:app --reload --port 8080 --host 0.0.0.0&quot;</span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;cwd&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;${workspaceFolder}&quot;</span>
<span class="p">}</span>
<span class="c1">// ... </span>
</code></pre></div>
<h3 id="option-2-set-environment-variables-in-current-shell">Option 2: Set environment variables in current shell</h3>
<p>Second, we can call <code>se activate</code> passing a type of a shell as additional parameter. This allows to generate scripts that can be used to set environment variables in the current shell session.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:3"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><input id="__tabbed_1_3" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">bash</label><label for="__tabbed_1_2">PowerShell</label><label for="__tabbed_1_3">Command Prompt</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1"># preview the script</span>
$<span class="w"> </span>se<span class="w"> </span>activate<span class="w"> </span>dev<span class="w"> </span>--bash

<span class="nb">export</span><span class="w"> </span><span class="nv">var1</span><span class="o">=</span><span class="s2">&quot;dev_var1&quot;</span><span class="p">;</span><span class="nb">export</span><span class="w"> </span><span class="nv">var2</span><span class="o">=</span><span class="s2">&quot;param1_value - param2_value&quot;</span><span class="p">;</span><span class="nb">export</span><span class="w"> </span><span class="nv">var3</span><span class="o">=</span><span class="s2">&quot;param3_value&quot;</span><span class="p">;</span><span class="nb">export</span><span class="w"> </span><span class="nv">env_name</span><span class="o">=</span><span class="s2">&quot;dev_env&quot;</span>

<span class="c1"># execute the script to set env variables</span>
$<span class="w"> </span><span class="nb">eval</span><span class="w"> </span><span class="k">$(</span>se<span class="w"> </span>activate<span class="w"> </span>dev<span class="w"> </span>--bash<span class="k">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c"># preview the script</span>
<span class="p">&gt;</span> <span class="n">se</span> <span class="n">activate</span> <span class="n">dev</span> <span class="p">-</span><span class="n">-ps</span>

<span class="nv">$env:var1</span><span class="p">=</span><span class="s2">&quot;dev_var1&quot;</span><span class="p">;</span><span class="nv">$env:var2</span><span class="p">=</span><span class="s2">&quot;param1_value - param2_value&quot;</span><span class="p">;</span><span class="nv">$env:var3</span><span class="p">=</span><span class="s2">&quot;param3_value&quot;</span><span class="p">;</span><span class="nv">$env:env_name</span><span class="p">=</span><span class="s2">&quot;dev_env&quot;</span>

<span class="c"># execute the script</span>
<span class="p">&gt;</span> <span class="nb">Invoke-Expression</span> <span class="p">$(</span><span class="n">se</span> <span class="n">activate</span> <span class="n">dev</span> <span class="p">-</span><span class="n">-ps</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code># preview the script
&gt; se activate dev --cmd

set &quot;var1=dev_var1&quot;;set &quot;var2=param1_value - param2_value&quot;;set &quot;var3=param3_value&quot;;set &quot;env_name=dev_env&quot;

# copy/paste to execute the script manually
</code></pre></div>
</div>
</div>
</div>
<h3 id="option-3-generate-the-file-for-use-with-docker">Option 3: Generate the file for use with Docker</h3>
<p>If you work with Docker, you can also generate the file that can pass these environment variables from host to container via docker compose. In combination with Option 1 or Option 2 above, this allows to deliver environment variables to Docker container, without saving them to file.
<div class="highlight"><pre><span></span><code><span class="c1"># preview docker compose env file content</span>
$<span class="w"> </span>se<span class="w"> </span>activate<span class="w"> </span>dev<span class="w"> </span>--docker

<span class="nv">var1</span><span class="o">=</span><span class="si">${</span><span class="nv">var1</span><span class="si">}</span>
<span class="nv">var2</span><span class="o">=</span><span class="si">${</span><span class="nv">var2</span><span class="si">}</span>
<span class="nv">var3</span><span class="o">=</span><span class="si">${</span><span class="nv">var3</span><span class="si">}</span>
<span class="nv">env_name</span><span class="o">=</span><span class="si">${</span><span class="nv">env_name</span><span class="si">}</span>

<span class="c1"># write to .env file</span>
$<span class="w"> </span>se<span class="w"> </span>activate<span class="w"> </span>dev<span class="w"> </span>--docker<span class="w"> </span>--out<span class="w"> </span>docker-dev.env
</code></pre></div></p>
<h3 id="option-4-generate-env-file-not-recommended">Option 4: Generate .env file (not recommended)</h3>
<p>Finally, you can generate <code>.env</code> file containing all values, and use it with Docker or other tools.
<div class="highlight"><pre><span></span><code><span class="c1"># preview env file content</span>
$<span class="w"> </span>se<span class="w"> </span>activate<span class="w"> </span>dev<span class="w"> </span>--env

<span class="nv">var1</span><span class="o">=</span>dev_var1
<span class="nv">var2</span><span class="o">=</span>param1_value<span class="w"> </span>-<span class="w"> </span>param2_value
<span class="nv">var3</span><span class="o">=</span>param3_value
<span class="nv">env_name</span><span class="o">=</span>dev_env

<span class="c1"># write to .env file</span>
$<span class="w"> </span>se<span class="w"> </span>activate<span class="w"> </span>dev<span class="w"> </span>--env<span class="w"> </span>--out<span class="w"> </span>dev.env
</code></pre></div></p>
<div class="admonition danger">
<p class="admonition-title">Important</p>
<p>Please note that since this file will contain all values, including secrets, it is recommended to:</p>
<ol>
<li>use such files only if there is no option to load values from in-memory environment variables;</li>
<li>delete this file immediately after use.</li>
</ol>
</div>
<h2 id="how-to-definedebug-more-complex-config-files">How to define/debug more complex config files?</h2>
<p>Configs in previous examples were simple. When defining more complex configs <code>se resolve</code> command helps to debug variable interpolation and resolvers. It returns the entire config yaml file, with all values resolved.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">Debug dev configuration</label><label for="__tabbed_2_2">Debug dev+local configuration</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>se<span class="w"> </span>resolve<span class="w"> </span>dev

params:
<span class="w">  </span>param1:<span class="w"> </span>param1_value
<span class="w">  </span>param2:<span class="w"> </span>param2_value
<span class="w">  </span>param3:<span class="w"> </span>param3_value
<span class="w">  </span>env_name:<span class="w"> </span>dev_env
envs:
<span class="w">  </span>var1:<span class="w"> </span>dev_var1
<span class="w">  </span>var2:<span class="w"> </span>param1_value<span class="w"> </span>-<span class="w"> </span>param2_value
<span class="w">  </span>var3:<span class="w"> </span>param3_value
<span class="w">  </span>env_name:<span class="w"> </span>dev_env
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>se<span class="w"> </span>resolve<span class="w"> </span>dev<span class="w"> </span><span class="nb">local</span>

params:
<span class="w">  </span>param1:<span class="w"> </span>param1_value
<span class="w">  </span>param2:<span class="w"> </span>param2_value
<span class="w">  </span>param3:<span class="w"> </span>param3_value
<span class="w">  </span>env_name:<span class="w"> </span>dev_env
envs:
<span class="w">  </span>var1:<span class="w"> </span>dev_var1
<span class="w">  </span>var2:<span class="w"> </span>param1_value<span class="w"> </span>-<span class="w"> </span>param2_value
<span class="w">  </span>var3:<span class="w"> </span>param3_value
<span class="w">  </span>env_name:<span class="w"> </span>dev_env
<span class="w">  </span>http_proxy:<span class="w"> </span>http-proxy-url
<span class="w">  </span>https_proxy:<span class="w"> </span>https-proxy-url
<span class="w">  </span>no_proxy:<span class="w"> </span>no-proxy-configuration
</code></pre></div>
</div>
</div>
</div>
<p><b>Congratulations!</b> Now you are ready to <a href="../working-with-secrets/">start loading secrets</a>.</p>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["toc.integrate", "content.code.copy", "navigation.sections", "navigation.indexes", "navigation.tracking", "content.tabs.link"], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.88dd0f4e.min.js"></script>
      
    
  </body>
</html>